phase: '0'
task_id: TSK-P0-014
title: SECURITY DEFINER dynamic SQL linter (fail-closed)
owner_role: SECURITY_GUARDIAN
status: completed
depends_on:
- TSK-P0-001
touches:
- scripts/security/lint_security_definer_dynamic_sql.sh
- .github/workflows/invariants.yml
- tasks/TSK-P0-014/meta.yml
invariants:
- INV-009 (No dynamic SQL in SECURITY DEFINER)
work:
- Add linter that fails on dynamic SQL patterns in SECURITY DEFINER functions unless
  allowlisted.
- Wire into mechanical_invariants job; fail-closed on violations.
acceptance_criteria:
- CI fails if a SECURITY DEFINER function uses dynamic SQL without allowlist.
verification:
- scripts/security/lint_security_definer_dynamic_sql.sh
evidence:
- ./evidence/phase0/security_definer_dynamic_sql.json
failure_modes:
- Any dynamic SQL violation must fail.
must_read:
- docs/invariants/INVARIANTS_MANIFEST.yml
- scripts/db/verify_invariants.sh
- scripts/db/ci_invariant_gate.sql
notes: ''
client: codex_cli
assigned_agent: security_guardian
model: GPT-5.2-Codex
implementation_plan: docs/plans/phase0/TSK-P0-014/PLAN.md
implementation_log: docs/plans/phase0/TSK-P0-014/EXEC_LOG.md
