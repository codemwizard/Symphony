phase: "0"
task_id: "TSK-P0-103"
title: "Privilege posture closeout for business tables (REVOKE hygiene)"
owner_role: "DB_FOUNDATION"
status: "completed"
depends_on:
- "TSK-P0-086"
- "TSK-P0-089"
touches:
- "schema/migrations/**"
- "scripts/db/verify_invariants.sh"
- "docs/invariants/INVARIANTS_MANIFEST.yml"
- "tasks/TSK-P0-103/meta.yml"
invariants:
- "NEW: Revoke-first posture explicitly applied to new business tables"
work:
- "Add forward-only migration(s) to explicitly REVOKE ALL ON new business tables FROM PUBLIC (and ensure runtime roles do not gain direct DML)."
- "Add/extend verifier coverage so privilege posture on the new tables is mechanically asserted."
acceptance_criteria:
- "PUBLIC has no implicit privileges on new business tables."
- "Verifier emits evidence (directly or via existing DB gate evidence) and fails closed on privilege drift."
verification:
- "scripts/db/verify_invariants.sh"
evidence:
- "evidence/phase0/ci_invariant_gate.json"
failure_modes:
- "New tables rely on implicit privilege defaults."
- "Privilege drift is not detected mechanically."
- "Evidence file missing."
must_read:
- "docs/audits/TIER1_GAP_AUDIT_2026-02-06.md"
- "schema/migrations/0004_privileges.sql"
implementation_plan: "docs/plans/phase0/TSK-P0-090_audit_gap_closeout/PLAN.md"
implementation_log: "docs/plans/phase0/TSK-P0-090_audit_gap_closeout/EXEC_LOG.md"
notes: ""
client: "codex_cli"
assigned_agent: "db_foundation"
model: "<UNASSIGNED>"

