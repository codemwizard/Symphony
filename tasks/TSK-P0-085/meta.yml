phase: '0'
task_id: TSK-P0-085
title: Add multi-signature ingress schema hook
owner_role: DB_FOUNDATION
status: completed
depends_on:
- TSK-P0-073
touches:
- schema/migrations/**
- scripts/db/**
- tasks/TSK-P0-085/meta.yml
invariants:
- INV-095 (Multi-signature ingress hook exists)
work:
- Add signatures JSONB NOT NULL DEFAULT []::jsonb to ingress_attestations in a forward-only migration.
- Preserve legacy single-signature compatibility fields for Phase-0.
- Keep deep signature validation behavior out of scope.
acceptance_criteria:
- Multi-signature column exists with correct type/default/not-null posture.
- Existing ingress invariants remain intact.
verification:
- scripts/db/verify_invariants.sh
- scripts/db/tests/test_db_functions.sh
evidence:
- evidence/phase0/business_foundation_hooks.json
failure_modes:
- signatures column missing or wrong default.
- Regression in existing ingress invariants.
- Evidence file missing.
must_read:
- docs/PHASE0/BUSINESS_INVARIANTS_ADDITION_IMPLEMENTATION.md
- docs/plans/phase0/TSK-P0-080_business_invariants_addition/PLAN.md
implementation_plan: docs/plans/phase0/TSK-P0-080_business_invariants_addition/PLAN.md
implementation_log: docs/plans/phase0/TSK-P0-080_business_invariants_addition/EXEC_LOG.md
notes: ''
client: codex_cli
assigned_agent: db_foundation
model: <UNASSIGNED>
