phase: '0'
task_id: TSK-P0-040
title: Wire contract + SQLSTATE drift checks into CI
owner_role: SECURITY_GUARDIAN
status: completed
depends_on:
- TSK-P0-037
- TSK-P0-038
touches:
- .github/workflows/invariants.yml
- docs/plans/phase0/TSK-P0-040_ci_wiring_contract_sqlstate/PLAN.md
- docs/plans/phase0/TSK-P0-040_ci_wiring_contract_sqlstate/EXEC_LOG.md
- tasks/TSK-P0-040/meta.yml
invariants:
- INV-060
- INV-061
work:
- Ensure contract + SQLSTATE drift checks run in the fast-checks job.
- Ensure evidence uploads include evidence/phase0/**.
acceptance_criteria:
- Checks run before upload step.
- Evidence artifacts include phase0_contract.json and sqlstate_map_drift.json.
verification:
  - actionlint .github/workflows/invariants.yml
evidence:
- ./evidence/phase0/phase0_contract.json
- ./evidence/phase0/sqlstate_map_drift.json
failure_modes:
- Evidence file missing.
- Checks not executed in fast-checks job.
- Evidence not uploaded.
must_read:
- docs/invariants/INVARIANTS_MANIFEST.yml
- scripts/db/verify_invariants.sh
- scripts/db/ci_invariant_gate.sql
notes: ''
implementation_plan: docs/plans/phase0/TSK-P0-040_ci_wiring_contract_sqlstate/PLAN.md
implementation_log: docs/plans/phase0/TSK-P0-040_ci_wiring_contract_sqlstate/EXEC_LOG.md
client: codex_cli
assigned_agent: security_guardian
model: <UNASSIGNED>
