phase: '0'
task_id: TSK-P0-029
title: Expand DDL lock-risk lint for blocking operations
owner_role: SECURITY_GUARDIAN
status: completed
depends_on:
- TSK-P0-004
- TSK-P0-030
touches:
- scripts/security/lint_ddl_lock_risk.sh
invariants:
- INV-040 (Blocking DDL policy enforced)
work:
- For hot tables, require CREATE INDEX CONCURRENTLY and forbid blocking ALTER patterns.
- Keep this as migration lint (not runtime privilege gate).
- Ensure lint emits ./evidence/phase0/ddl_blocking_policy.json.
acceptance_criteria:
- CI fails on blocked patterns in migrations.
- Evidence file is written by the verification step.
verification:
- scripts/security/lint_ddl_lock_risk.sh
evidence:
- ./evidence/phase0/ddl_blocking_policy.json
failure_modes:
- Unsafe DDL passes lint.
- Evidence file missing.
must_read:
- docs/invariants/INVARIANTS_MANIFEST.yml
- scripts/db/verify_invariants.sh
- scripts/db/ci_invariant_gate.sql
notes: Invariant registration is handled by TSK-P0-009.
client: codex_cli
assigned_agent: security_guardian
model: <UNASSIGNED>
implementation_plan: docs/plans/phase0/TSK-P0-029/PLAN.md
implementation_log: docs/plans/phase0/TSK-P0-029/EXEC_LOG.md
