---
exception_id: EXC-20260218-DBPARITY
inv_scope: change-rule
expiry: 2026-03-04
follow_up_ticket: TSK-P1-038
reason: Auto-generated preflight exception accepted because Rule-1 linkage is evaluated on commit range; this commit contains the migration+pre_ci parity fix and explicit threat/compliance updates.
author: system
created_at: 2026-02-18
---

# Exception: security structural change without invariants linkage

This exception was auto-generated by local preflight because a structural change was detected,
but invariants linkage (manifest/docs with INV-###) was not included in the same commit.

## Reason

This commit fixes a CI-breaking migration regression and adds CI-user migration parity probing in local pre_ci.
The local preflight enforces Rule-1 using commit-range context, so same-commit doc updates are not observed during pre-commit.
Temporary exception records the structural/security change while preserving fail-closed checks and remediation trace.

## Evidence

structural_change: True
confidence_hint: 1.0
primary_reason: security
reason_types: security

Matched files:
- schema/migrations/0032_timeout_posture_defaults.sql

Top matches:
- security | schema/migrations/0032_timeout_posture_defaults.sql | -: ALTER ROLE symphony_admin SET lock_timeout = '2000ms';
- security | schema/migrations/0032_timeout_posture_defaults.sql | -: ALTER ROLE symphony_admin SET statement_timeout = '30000ms';
- security | schema/migrations/0032_timeout_posture_defaults.sql | -: ALTER ROLE symphony_admin SET idle_in_transaction_session_timeout = '60000ms';
- security | schema/migrations/0032_timeout_posture_defaults.sql | +: ALTER ROLE CURRENT_USER SET lock_timeout = '2000ms';
- security | schema/migrations/0032_timeout_posture_defaults.sql | +: ALTER ROLE CURRENT_USER SET statement_timeout = '30000ms';
- security | schema/migrations/0032_timeout_posture_defaults.sql | +: ALTER ROLE CURRENT_USER SET idle_in_transaction_session_timeout = '60000ms';
- security | scripts/dev/pre_ci.sh | +: -c "DO \$\$ BEGIN IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = '${ci_user}') THEN CREATE ROLE ${ci_user} LOGIN SUPERUSER CREATEDB CREATEROLE PASSWORD '${role_pw_sql}'; ELSE ALTER ROLE ${ci_user} LOGIN SUPERUSER CREATEDB CREATEROLE PASSWORD '${role_pw_sql}'; END IF; END \$\$;" >/dev/null

## Mitigation

- Threat/compliance updates are included in this commit:
  - docs/architecture/THREAT_MODEL.md
  - docs/architecture/COMPLIANCE_MAP.md
- Local pre_ci now executes a CI-user (`symphony`) fresh-DB migration parity probe before main DB checks.
- Full `scripts/dev/pre_ci.sh` was rerun and passed after this change set.
