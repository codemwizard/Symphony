---
exception_id: EXC-2026-02-14-03
inv_scope: change-rule
expiry: 2026-02-28
follow_up_ticket: FOLLOWUP-P1-ANCHOR-SYNC-DDL
reason: Auto-generated: structural change detected; invariants linkage missing in commit.
author: system
created_at: 2026-02-14
---

# Exception: ddl structural change without invariants linkage

This exception was auto-generated by local preflight because a structural change was detected,
but invariants linkage (manifest/docs with INV-###) was not included in the same commit.

## Reason

Auto-generated exception for structural-change linkage preflight.
Manual review is required to confirm final invariant linkage and closeout timeline.

## Evidence

structural_change: True
confidence_hint: 1.0
primary_reason: ddl
reason_types: ddl, migration_file_added_or_deleted, security

Matched files:
- schema/migrations/0032_anchor_sync_operational_enforcement.sql
- schema/migrations/0033_anchor_sync_operational_fix_append_only_and_lease_time.sql

Top matches:
- ddl | docs/security/ddl_allowlist.json | +: "reason": "Phase-1 anchor-sync operational fix extends state ledger with anchor_type metadata via ALTER TABLE (non-hot table).",
- ddl | schema/baseline.sql | +: CREATE TABLE public.anchor_sync_operations (
- ddl | schema/baseline.sql | +: CONSTRAINT anchor_sync_operations_attempt_count_check CHECK ((attempt_count >= 0)),
- ddl | schema/baseline.sql | +: CONSTRAINT anchor_sync_operations_state_check CHECK ((state = ANY (ARRAY['PENDING'::text, 'ANCHORING'::text, 'ANCHORED'::text, 'COMPLETED'::text, 'FAILED'::text]))),
- ddl | schema/baseline.sql | +: CONSTRAINT ck_anchor_sync_completed_requires_anchor_ref CHECK (((state <> 'COMPLETED'::text) OR (anchor_ref IS NOT NULL)))
- ddl | schema/baseline.sql | +: ALTER TABLE ONLY public.anchor_sync_operations
- ddl | schema/baseline.sql | +: ADD CONSTRAINT anchor_sync_operations_pack_id_key UNIQUE (pack_id);
- ddl | schema/baseline.sql | +: ALTER TABLE ONLY public.anchor_sync_operations
- ddl | schema/baseline.sql | +: ADD CONSTRAINT anchor_sync_operations_pkey PRIMARY KEY (operation_id);
- ddl | schema/baseline.sql | +: CREATE INDEX idx_anchor_sync_operations_state_due ON public.anchor_sync_operations USING btree (state, lease_expires_at, updated_at);
- ddl | schema/baseline.sql | +: ALTER TABLE ONLY public.anchor_sync_operations
- ddl | schema/baseline.sql | +: ADD CONSTRAINT anchor_sync_operations_pack_id_fkey FOREIGN KEY (pack_id) REFERENCES public.evidence_packs(pack_id);
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: SELECT pg_catalog.set_config('search_path', '', false);
- ddl | schema/baselines/2026-02-14/0001_baseline.sql | +: CREATE TYPE public.outbox_attempt_state AS ENUM (
- ddl | schema/baselines/2026-02-14/0001_baseline.sql | +: CREATE TYPE public.policy_version_status AS ENUM (
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: LANGUAGE plpgsql SECURITY DEFINER
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: SET search_path TO 'pg_catalog', 'public'
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: LANGUAGE sql SECURITY DEFINER
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: SET search_path TO 'pg_catalog', 'public'
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: LANGUAGE plpgsql SECURITY DEFINER
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: SET search_path TO 'pg_catalog', 'public'
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: LANGUAGE plpgsql SECURITY DEFINER
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: SET search_path TO 'pg_catalog', 'public'
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: LANGUAGE plpgsql SECURITY DEFINER
- security | schema/baselines/2026-02-14/0001_baseline.sql | +: SET search_path TO 'pg_catalog', 'public'

## Mitigation

- Mechanical gates remain enabled (security + integrity + compliance checks).
- Exception is timeboxed and must be closed by the follow-up ticket before expiry.
