# Invariants Implemented

These invariants are **implemented** when they are (a) described, and (b) have at least one concrete enforcement/verification evidence link below. If evidence is missing, downgrade the manifest status to `roadmap` and add a verification hook.

_Generated mechanically from `docs/invariants/INVARIANTS_MANIFEST.yml`._

| ID | Aliases | Severity | Title | Owners | Verification (manifest) | Evidence links |
|---|---|---|---|---|---|---|
| INV-001 | I-MIG-02 | P0 | Applied migrations are immutable (checksum ledger) | team-db | scripts/db/migrate.sh checksum check; run via scripts/db/verify_invariants.sh | [`scripts/db/migrate.sh L7-L11`](../../scripts/db/migrate.sh#L7-L11)<br>[`scripts/db/verify_invariants.sh L22-L26`](../../scripts/db/verify_invariants.sh#L22-L26)<br>[`scripts/db/ci_invariant_gate.sql L9-L13`](../../scripts/db/ci_invariant_gate.sql#L9-L13) |
| INV-002 | I-MIG-03 | P0 | Migration files must not contain top-level BEGIN/COMMIT | team-db | scripts/db/lint_migrations.sh; run via scripts/db/verify_invariants.sh | [`scripts/db/lint_migrations.sh L1-L5`](../../scripts/db/lint_migrations.sh#L1-L5)<br>[`scripts/db/verify_invariants.sh L22-L26`](../../scripts/db/verify_invariants.sh#L22-L26)<br>[`scripts/db/migrate.sh L66-L70`](../../scripts/db/migrate.sh#L66-L70) |
| INV-003 | I-MIG-04 | P0 | Fix forward only: changes via new migrations, never by editing applied ones | team-db | Same mechanical enforcement as INV-001 (checksum immutability) | [`scripts/db/ci_invariant_gate.sql L9-L13`](../../scripts/db/ci_invariant_gate.sql#L9-L13)<br>[`scripts/db/migrate.sh L7-L11`](../../scripts/db/migrate.sh#L7-L11)<br>[`scripts/db/lint_migrations.sh L1-L5`](../../scripts/db/lint_migrations.sh#L1-L5) |
| INV-004 | I-MIG-05 | P1 | Baseline snapshot is derived from migrations and must not drift | team-db | scripts/db/check_baseline_drift.sh | [`scripts/db/check_baseline_drift.sh L1-L60`](../../scripts/db/check_baseline_drift.sh#L1-L60)<br>[`schema/baseline.sql L1-L5`](../../schema/baseline.sql#L1-L5) |
| INV-005 | I-SEC-01 | P0 | Deny-by-default privileges (revoke-first posture) | team-platform | schema/migrations/0004_privileges.sql; scripts/db/ci_invariant_gate.sql checks schema/public privileges | [`schema/migrations/0004_privileges.sql L1-L4`](../../schema/migrations/0004_privileges.sql#L1-L4)<br>[`scripts/db/ci_invariant_gate.sql L86-L90`](../../scripts/db/ci_invariant_gate.sql#L86-L90)<br>[`scripts/db/migrate.sh L31-L35`](../../scripts/db/migrate.sh#L31-L35) |
| INV-006 | I-SEC-02 | P0 | No runtime DDL: PUBLIC/runtime roles must not have CREATE on schema public | team-platform | scripts/db/ci_invariant_gate.sql section 'No runtime DDL' (has_schema_privilege(...,'CREATE')) | [`scripts/db/ci_invariant_gate.sql L10-L14`](../../scripts/db/ci_invariant_gate.sql#L10-L14)<br>[`schema/migrations/0001_init.sql L16-L20`](../../schema/migrations/0001_init.sql#L16-L20)<br>[`schema/migrations/0002_outbox_functions.sql L7-L11`](../../schema/migrations/0002_outbox_functions.sql#L7-L11) |
| INV-007 | I-SEC-03 | P0 | Runtime roles are NOLOGIN templates; services assume them via SET ROLE | team-platform | schema/migrations/0003_roles.sql creates roles NOLOGIN; TODO: add CI gate for rolcanlogin | [`schema/migrations/0003_roles.sql L7-L11`](../../schema/migrations/0003_roles.sql#L7-L11)<br>[`schema/migrations/0001_init.sql L1-L5`](../../schema/migrations/0001_init.sql#L1-L5)<br>[`schema/migrations/0004_privileges.sql L6-L10`](../../schema/migrations/0004_privileges.sql#L6-L10) |
| INV-008 | I-SEC-04 | P0 | SECURITY DEFINER functions must pin search_path to pg_catalog, public | team-platform | scripts/db/lint_search_path.sh; run via scripts/db/verify_invariants.sh | [`scripts/db/lint_search_path.sh L1-L5`](../../scripts/db/lint_search_path.sh#L1-L5)<br>[`scripts/db/verify_invariants.sh L23-L27`](../../scripts/db/verify_invariants.sh#L23-L27)<br>[`schema/migrations/0002_outbox_functions.sql L27-L31`](../../schema/migrations/0002_outbox_functions.sql#L27-L31) |
| INV-010 | I-SEC-06 | P0 | Runtime roles have no direct DML on core tables; writes happen via DB API functions | team-platform | scripts/db/ci_invariant_gate.sql section 'Runtime roles have no direct table privileges on outbox tables' | [`scripts/db/ci_invariant_gate.sql L21-L25`](../../scripts/db/ci_invariant_gate.sql#L21-L25)<br>[`schema/migrations/0002_outbox_functions.sql L1-L4`](../../schema/migrations/0002_outbox_functions.sql#L1-L4)<br>[`schema/migrations/0004_privileges.sql L29-L33`](../../schema/migrations/0004_privileges.sql#L29-L33) |
| INV-011 | I-OB-01 | P0 | Outbox enqueue is idempotent on (instruction_id, idempotency_key) | team-db | schema/migrations/0002_outbox_functions.sql unique constraint + enqueue_payment_outbox(); TODO: add behavioral test to CI | [`schema/migrations/0002_outbox_functions.sql L47-L51`](../../schema/migrations/0002_outbox_functions.sql#L47-L51)<br>[`scripts/db/ci_invariant_gate.sql L206-L210`](../../scripts/db/ci_invariant_gate.sql#L206-L210)<br>[`scripts/db/verify_invariants.sh L35-L39`](../../scripts/db/verify_invariants.sh#L35-L39) |
| INV-012 | I-OB-02 | P0 | Outbox claim uses FOR UPDATE SKIP LOCKED and only due/unleased or expired rows | team-db | schema/migrations/0002_outbox_functions.sql claim_outbox_batch() uses SKIP LOCKED; TODO: add behavioral test to CI | [`schema/migrations/0002_outbox_functions.sql L140-L144`](../../schema/migrations/0002_outbox_functions.sql#L140-L144)<br>[`scripts/db/ci_invariant_gate.sql L21-L25`](../../scripts/db/ci_invariant_gate.sql#L21-L25)<br>[`scripts/db/migrate.sh L60-L64`](../../scripts/db/migrate.sh#L60-L64) |
| INV-013 | I-OB-03 | P0 | Strict lease fencing: completion requires matching claimed_by + lease_token and non-expired lease | team-db | schema/migrations/0002_outbox_functions.sql complete_outbox_attempt() validates lease; TODO: add behavioral test to CI | [`schema/migrations/0002_outbox_functions.sql L154-L158`](../../schema/migrations/0002_outbox_functions.sql#L154-L158)<br>[`scripts/db/lint_migrations.sh L12-L16`](../../scripts/db/lint_migrations.sh#L12-L16)<br>[`scripts/db/migrate.sh L4-L8`](../../scripts/db/migrate.sh#L4-L8) |
| INV-014 | I-OB-04 | P0 | payment_outbox_attempts is append-only; no UPDATE/DELETE | team-db | schema/migrations/0001_init.sql trigger denies mutation; scripts/db/ci_invariant_gate.sql validates trigger exists | [`scripts/db/ci_invariant_gate.sql L18-L22`](../../scripts/db/ci_invariant_gate.sql#L18-L22)<br>[`schema/migrations/0001_init.sql L131-L135`](../../schema/migrations/0001_init.sql#L131-L135)<br>[`schema/migrations/0004_privileges.sql L30-L34`](../../schema/migrations/0004_privileges.sql#L30-L34) |
| INV-015 | I-OB-05 | P0 | Outbox retry ceiling is finite | team-db | scripts/db/ci_invariant_gate.sql verifies symphony.outbox_retry_ceiling GUC and >=1 | [`scripts/db/ci_invariant_gate.sql L21-L25`](../../scripts/db/ci_invariant_gate.sql#L21-L25)<br>[`schema/migrations/0002_outbox_functions.sql L5-L9`](../../schema/migrations/0002_outbox_functions.sql#L5-L9)<br>[`schema/migrations/0001_init.sql L1-L5`](../../schema/migrations/0001_init.sql#L1-L5) |
| INV-031 | I-OB-INDEX-01 | P0 | Outbox claim index required | team-db | scripts/db/tests/test_outbox_pending_indexes.sh | [`scripts/db/tests/test_outbox_pending_indexes.sh`](../../scripts/db/tests/test_outbox_pending_indexes.sh)<br>[`schema/migrations/0013_outbox_pending_indexes_concurrently.sql L1-L4`](../../schema/migrations/0013_outbox_pending_indexes_concurrently.sql#L1-L4) |
| INV-033 | I-OB-MVCC-01 | P1 | Outbox MVCC posture enforced | team-db | scripts/db/verify_invariants.sh (reloptions check) | [`scripts/db/verify_invariants.sh`](../../scripts/db/verify_invariants.sh)<br>[`schema/migrations/0009_pending_fillfactor.sql L1-L4`](../../schema/migrations/0009_pending_fillfactor.sql#L1-L4) |
| INV-016 | I-POL-01 | P0 | policy_versions exists and supports boot query shape (is_active=true) | team-platform | scripts/db/ci_invariant_gate.sql checks policy_versions exists and has is_active column | [`scripts/db/ci_invariant_gate.sql L8-L12`](../../scripts/db/ci_invariant_gate.sql#L8-L12)<br>[`scripts/db/migrate.sh L7-L11`](../../scripts/db/migrate.sh#L7-L11)<br>[`schema/migrations/0005_policy_versions.sql L1-L4`](../../schema/migrations/0005_policy_versions.sql#L1-L4) |
| INV-017 | I-POL-02 | P0 | policy_versions.checksum is NOT NULL | team-platform | scripts/db/ci_invariant_gate.sql asserts checksum column is NOT NULL | [`scripts/db/ci_invariant_gate.sql L9-L13`](../../scripts/db/ci_invariant_gate.sql#L9-L13)<br>[`scripts/db/migrate.sh L10-L14`](../../scripts/db/migrate.sh#L10-L14)<br>[`scripts/db/lint_migrations.sh L10-L14`](../../scripts/db/lint_migrations.sh#L10-L14) |
| INV-018 | I-POL-03 | P0 | Single ACTIVE policy row enforced by unique predicate index | team-platform | scripts/db/ci_invariant_gate.sql asserts unique index on policy_versions where status='ACTIVE' | [`scripts/db/ci_invariant_gate.sql L8-L12`](../../scripts/db/ci_invariant_gate.sql#L8-L12)<br>[`scripts/db/verify_invariants.sh L51-L55`](../../scripts/db/verify_invariants.sh#L51-L55)<br>[`schema/migrations/0001_init.sql L69-L73`](../../schema/migrations/0001_init.sql#L69-L73) |
| INV-019 | I-REPO-01 | P0 | Repo structure is enforced (required directories + doc references) | team-platform | scripts/audit/verify_repo_structure.sh | [`scripts/audit/verify_repo_structure.sh L1-L154`](../../scripts/audit/verify_repo_structure.sh#L1-L154)<br>[`.github/workflows/invariants.yml L141-L152`](../../.github/workflows/invariants.yml#L141-L152) |
| INV-020 | I-EVID-01 | P0 | Evidence anchoring: git SHA + schema hash | team-platform | scripts/audit/generate_evidence.sh | [`scripts/audit/generate_evidence.sh L1-L108`](../../scripts/audit/generate_evidence.sh#L1-L108)<br>[`docs/architecture/evidence_schema.json L1-L27`](../../docs/architecture/evidence_schema.json#L1-L27) |
| INV-021 | I-DB-01 | P0 | N-1 compatibility gate | team-db | scripts/db/n_minus_one_check.sh | [`scripts/db/n_minus_one_check.sh L1-L200`](../../scripts/db/n_minus_one_check.sh#L1-L200)<br>[`.github/workflows/invariants.yml L226-L236`](../../.github/workflows/invariants.yml#L226-L236) |
| INV-022 |  | P0 | DDL lock-risk lint (blocking operations) | team-security | scripts/security/lint_ddl_lock_risk.sh | [`scripts/security/lint_ddl_lock_risk.sh`](../../scripts/security/lint_ddl_lock_risk.sh) |
| INV-023 |  | P0 | Idempotency zombie replay safety | team-db | scripts/db/tests/test_idempotency_zombie.sh | [`scripts/db/tests/test_idempotency_zombie.sh`](../../scripts/db/tests/test_idempotency_zombie.sh) |
| INV-024 |  | P0 | OpenBao AppRole auth + deny policy | team-security | scripts/security/openbao_smoke_test.sh (after openbao_bootstrap.sh) | [`scripts/security/openbao_smoke_test.sh`](../../scripts/security/openbao_smoke_test.sh)<br>[`scripts/security/openbao_bootstrap.sh`](../../scripts/security/openbao_bootstrap.sh) |
| INV-025 |  | P0 | Blue/Green rollback compatibility | team-platform | scripts/audit/verify_routing_fallback.sh | [`scripts/audit/verify_routing_fallback.sh`](../../scripts/audit/verify_routing_fallback.sh) |
| INV-026 |  | P0 | Routing fallback invariant | team-platform | scripts/audit/validate_routing_fallback.sh | [`scripts/audit/validate_routing_fallback.sh`](../../scripts/audit/validate_routing_fallback.sh) |
| INV-027 |  | P0 | Batching rules defined and enforced | team-platform | scripts/audit/verify_batching_rules.sh | [`scripts/audit/verify_batching_rules.sh`](../../scripts/audit/verify_batching_rules.sh) |
| INV-028 |  | P0 | Evidence schema validation | team-platform | scripts/audit/validate_evidence_schema.sh | [`scripts/audit/validate_evidence_schema.sh`](../../scripts/audit/validate_evidence_schema.sh) |
| INV-029 |  | P0 | Evidence provenance required | team-platform | scripts/audit/generate_evidence.sh + scripts/audit/validate_evidence_schema.sh | [`scripts/audit/generate_evidence.sh`](../../scripts/audit/generate_evidence.sh)<br>[`scripts/audit/validate_evidence_schema.sh`](../../scripts/audit/validate_evidence_schema.sh) |
| INV-030 |  | P1 | Threat/compliance docs updated on structural change | team-platform | scripts/audit/enforce_change_rule.sh | [`scripts/audit/enforce_change_rule.sh`](../../scripts/audit/enforce_change_rule.sh) |
| INV-032 | I-OB-TERM-01 | P0 | One terminal attempt per outbox_id | team-db | scripts/db/tests/test_db_functions.sh (terminal uniqueness) | [`scripts/db/tests/test_db_functions.sh`](../../scripts/db/tests/test_db_functions.sh)<br>[`schema/migrations/0008_outbox_terminal_uniqueness.sql L1-L3`](../../schema/migrations/0008_outbox_terminal_uniqueness.sql#L1-L3) |
| INV-034 | I-OB-NOTIFY-01 | P1 | Outbox wakeup notification | team-db | scripts/db/tests/test_db_functions.sh (NOTIFY emission) | [`scripts/db/tests/test_db_functions.sh`](../../scripts/db/tests/test_db_functions.sh)<br>[`schema/migrations/0010_outbox_notify.sql L1-L6`](../../schema/migrations/0010_outbox_notify.sql#L1-L6) |
| INV-035 | I-ING-ATT-01 | P1 | Ingress attestation append-only | team-db | scripts/db/verify_invariants.sh (ingress_attestations checks) | [`scripts/db/verify_invariants.sh`](../../scripts/db/verify_invariants.sh)<br>[`schema/migrations/0011_ingress_attestations.sql L1-L12`](../../schema/migrations/0011_ingress_attestations.sql#L1-L12) |
| INV-036 | I-REV-01 | P0 | Revocation tables present + append-only | team-security | scripts/db/verify_invariants.sh (revocation tables checks) | [`scripts/db/verify_invariants.sh`](../../scripts/db/verify_invariants.sh)<br>[`schema/migrations/0012_revocation_tables.sql L1-L12`](../../schema/migrations/0012_revocation_tables.sql#L1-L12) |
| INV-037 | I-CORE-BOUND-01 | P1 | Core code boundary enforced | team-security | scripts/security/lint_core_boundary.sh | [`scripts/security/lint_core_boundary.sh`](../../scripts/security/lint_core_boundary.sh) |
| INV-038 | I-ARCH-ALIGN-01 | P1 | Architecture doc alignment | team-platform | rg -n "node|Node.js" docs/overview/architecture.md docs/decisions/ADR-0001-repo-structure.md | [`docs/overview/architecture.md`](../../docs/overview/architecture.md)<br>[`docs/decisions/ADR-0001-repo-structure.md`](../../docs/decisions/ADR-0001-repo-structure.md) |
| INV-040 | I-DB-DDL-02 | P0 | Blocking DDL policy enforced (hot tables) | team-security | scripts/security/lint_ddl_lock_risk.sh | [`scripts/security/lint_ddl_lock_risk.sh`](../../scripts/security/lint_ddl_lock_risk.sh) |
| INV-041 | I-MIG-NOTX-01 | P0 | No-tx migrations supported | team-db | scripts/db/tests/test_no_tx_migrations.sh | [`scripts/db/tests/test_no_tx_migrations.sh`](../../scripts/db/tests/test_no_tx_migrations.sh)<br>[`scripts/db/migrate.sh`](../../scripts/db/migrate.sh) |
| INV-042 | I-MIG-NOTX-02 | P0 | Concurrent index requires no-tx marker | team-db | scripts/db/lint_migrations.sh | [`scripts/db/lint_migrations.sh`](../../scripts/db/lint_migrations.sh) |
| INV-043 | I-MIG-NOTX-03 | P1 | No-tx migration guidance | team-platform | rg -n "symphony:no_tx" docs/operations/DEV_WORKFLOW.md | [`docs/operations/DEV_WORKFLOW.md`](../../docs/operations/DEV_WORKFLOW.md) |
| INV-044 | I-DOCS-DRIFT-01 | P0 | Invariants docs match manifest | team-platform | scripts/audit/check_docs_match_manifest.py | [`scripts/audit/check_docs_match_manifest.py`](../../scripts/audit/check_docs_match_manifest.py) |
| INV-060 | I-P0-CONTRACT-01 | P1 | Phase-0 contract governs evidence gate | team-platform | scripts/audit/verify_phase0_contract.sh | [`scripts/audit/verify_phase0_contract.sh`](../../scripts/audit/verify_phase0_contract.sh) |
| INV-061 | I-SQLSTATE-REGISTRY-01 | P1 | SQLSTATE registry is complete and drift-free | team-platform | scripts/audit/check_sqlstate_map_drift.sh | [`scripts/audit/check_sqlstate_map_drift.sh`](../../scripts/audit/check_sqlstate_map_drift.sh) |
| INV-062 | I-TEN-01 | P1 | Tenant hierarchy tables exist (tenants, tenant_clients, tenant_members) | team-db | scripts/db/verify_tenant_member_hooks.sh | [`scripts/db/verify_tenant_member_hooks.sh`](../../scripts/db/verify_tenant_member_hooks.sh) |
| INV-063 | I-TEN-02 | P1 | Ingress attestations require tenant attribution and support client/member linkage | team-db | scripts/db/verify_tenant_member_hooks.sh | [`scripts/db/verify_tenant_member_hooks.sh`](../../scripts/db/verify_tenant_member_hooks.sh) |
| INV-064 | I-TEN-03 | P1 | Member/tenant consistency guard enforced on ingress | team-db | scripts/db/verify_tenant_member_hooks.sh | [`scripts/db/verify_tenant_member_hooks.sh`](../../scripts/db/verify_tenant_member_hooks.sh) |
| INV-065 | I-TEN-04 | P1 | Outbox tables include tenant/member attribution columns (expand-first) | team-db | scripts/db/verify_tenant_member_hooks.sh | [`scripts/db/verify_tenant_member_hooks.sh`](../../scripts/db/verify_tenant_member_hooks.sh) |
| INV-066 | I-TEN-05 | P1 | Ingress attestations are unique per (tenant_id, instruction_id) | team-db | scripts/db/verify_tenant_member_hooks.sh | [`scripts/db/verify_tenant_member_hooks.sh`](../../scripts/db/verify_tenant_member_hooks.sh) |
| INV-067 | I-BASELINE-GOV-01 | P1 | Baseline changes require migration + ADR update | team-platform | scripts/audit/verify_baseline_change_governance.sh | [`scripts/audit/verify_baseline_change_governance.sh`](../../scripts/audit/verify_baseline_change_governance.sh) |
| INV-068 | I-DDL-ALLOWLIST-01 | P1 | DDL allowlist governance enforced (fingerprints + expiry + review) | team-security | scripts/security/verify_ddl_allowlist_governance.sh | [`scripts/security/verify_ddl_allowlist_governance.sh`](../../scripts/security/verify_ddl_allowlist_governance.sh) |
| INV-069 | I-P0-PLAN-01 | P1 | Phase-0 implementation plan is current | team-platform | scripts/audit/verify_phase0_impl_plan.sh | [`scripts/audit/verify_phase0_impl_plan.sh`](../../scripts/audit/verify_phase0_impl_plan.sh) |
| INV-070 | I-BASELINE-REB-01 | P1 | Day-zero rebaseline strategy is documented and enforced | team-platform, team-db | scripts/audit/verify_rebaseline_strategy.sh | [`scripts/audit/verify_rebaseline_strategy.sh`](../../scripts/audit/verify_rebaseline_strategy.sh) |
| INV-071 | I-3P-01 | P1 | Three-Pillar control-plane model is documented and enforced | team-platform | scripts/audit/verify_three_pillars_doc.sh | [`scripts/audit/verify_three_pillars_doc.sh`](../../scripts/audit/verify_three_pillars_doc.sh) |
| INV-072 | I-3P-02 | P1 | Control-plane gates are declared and drift-checked | team-platform | scripts/audit/verify_control_planes_drift.sh | [`scripts/audit/verify_control_planes_drift.sh`](../../scripts/audit/verify_control_planes_drift.sh) |
| INV-073 | I-SEC-PLANE-01 | P1 | Security plane guardrails are enforced (secrets/deps/config/code) | team-security | scripts/audit/run_security_fast_checks.sh | [`scripts/audit/run_security_fast_checks.sh`](../../scripts/audit/run_security_fast_checks.sh) |
| INV-075 | I-COMP-VERIFY-01 | P1 | Compliance manifest is complete and gate-mapped | team-compliance | scripts/audit/verify_compliance_manifest.sh | [`scripts/audit/verify_compliance_manifest.sh`](../../scripts/audit/verify_compliance_manifest.sh) |
| INV-076 | I-AGENT-SCOPE-01 | P1 | Agent scopes align with control-plane ownership | team-platform | scripts/audit/verify_control_planes_drift.sh | [`scripts/audit/verify_control_planes_drift.sh`](../../scripts/audit/verify_control_planes_drift.sh) |
| INV-077 | I-EVIDENCE-SCHEMA-01 | P1 | Evidence schema is canonical and validated | team-platform | scripts/audit/validate_evidence_schema.sh | [`scripts/audit/validate_evidence_schema.sh`](../../scripts/audit/validate_evidence_schema.sh) |
| INV-078 | I-YAML-01 | P1 | YAML conventions are normalized and linted | team-platform | scripts/audit/lint_yaml_conventions.sh | [`scripts/audit/lint_yaml_conventions.sh`](../../scripts/audit/lint_yaml_conventions.sh) |
| INV-079 | I-CI-TOOLCHAIN-01 | P1 | CI toolchain is pinned (PyYAML + ripgrep) | team-security | scripts/audit/verify_ci_toolchain.sh | [`scripts/audit/verify_ci_toolchain.sh`](../../scripts/audit/verify_ci_toolchain.sh) |
| INV-080 | I-CONTRACT-STATUS-01 | P1 | Phase-0 contract evidence status semantics enforced | team-platform | scripts/audit/verify_phase0_contract_evidence_status.sh | [`scripts/audit/verify_phase0_contract_evidence_status.sh`](../../scripts/audit/verify_phase0_contract_evidence_status.sh) |
| INV-081 | I-CI-ORDER-01 | P1 | Pre-CI and CI ordered checks aligned | team-platform | scripts/audit/verify_ci_order.sh | [`scripts/audit/verify_ci_order.sh`](../../scripts/audit/verify_ci_order.sh) |
| INV-090 | I-BILL-HOOK-01 | P1 | Billing usage ledger hook exists and is append-only | team-db | scripts/db/verify_business_foundation_hooks.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`schema/migrations/0020_business_foundation_hooks.sql`](../../schema/migrations/0020_business_foundation_hooks.sql) |
| INV-091 | I-PROOF-HOOK-01 | P1 | External proofs hook exists and is append-only | team-db | scripts/db/verify_business_foundation_hooks.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`schema/migrations/0020_business_foundation_hooks.sql`](../../schema/migrations/0020_business_foundation_hooks.sql) |
| INV-092 | I-STITCH-HOOK-01 | P1 | Correlation stitching hooks exist on ingress and outbox tables | team-db | scripts/db/verify_business_foundation_hooks.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`schema/migrations/0021_correlation_indexes_concurrently.sql`](../../schema/migrations/0021_correlation_indexes_concurrently.sql) |
| INV-093 | I-EVID-PACK-01 | P1 | Evidence pack primitives exist and are append-only | team-db | scripts/db/verify_business_foundation_hooks.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`schema/migrations/0020_business_foundation_hooks.sql`](../../schema/migrations/0020_business_foundation_hooks.sql) |
| INV-094 | I-TEN-BILL-01 | P1 | Tenant billable hierarchy hooks exist (billable root + parent) | team-db | scripts/db/verify_business_foundation_hooks.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`schema/migrations/0020_business_foundation_hooks.sql`](../../schema/migrations/0020_business_foundation_hooks.sql) |
| INV-095 | I-IPDR-SIG-01 | P1 | Ingress multi-signature hook exists with safe default | team-db | scripts/db/verify_business_foundation_hooks.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`schema/migrations/0020_business_foundation_hooks.sql`](../../schema/migrations/0020_business_foundation_hooks.sql) |
| INV-096 | I-BIZ-HOOKS-VERIFY-01 | P1 | Business foundation hooks are mechanically verified in DB gate | team-db, team-platform | scripts/db/verify_business_foundation_hooks.sh; wired via scripts/db/verify_invariants.sh | [`scripts/db/verify_business_foundation_hooks.sh`](../../scripts/db/verify_business_foundation_hooks.sh)<br>[`scripts/db/verify_invariants.sh`](../../scripts/db/verify_invariants.sh) |
